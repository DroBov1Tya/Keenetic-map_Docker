# Keenetic-map

## Описание

Проект **keenetic-map** предназначен для сбора и хранения актуальной информации о подключенных к роутеру Keenetic устройствах. Информация включает такие данные, как MAC-адрес, IP-адрес, имя устройства, статус подключения и т.д. Собранные данные сохраняются в базе данных, состоящей из двух таблиц: `devices` и `devices_history`.

### Структура базы данных

1. **Таблица `devices`**:
    - Хранит только актуальные данные о подключенных устройствах.
    - Обновление данных происходит каждую минуту: старая информация перезаписывается, а индексация сбрасывается до 1.

2. **Таблица `devices_history`**:
    - Хранит историю подключений устройств.
    - Данные обновляются каждую минуту, сохраняя все изменения и историю подключений.

### Компоненты проекта

Проект состоит из двух Docker-контейнеров:

1. **API контейнер**:
    - Отвечает за взаимодействие с базой данных.
    - Запускает FastAPI сервис для обработки запросов и записи данных в таблицы базы данных.

2. **Loop контейнер**:
    - Каждую минуту собирает информацию о подключенных устройствах к роутеру.
    - Отправляет актуальные данные в API для записи в базу данных.
    
3. **Postgres контейнер**
    - Контейнеризированная база данных проекта

### Команда для запуска:

```
docker compose up --build
```

   Это создаст и запустит два контейнера — `api` и `loop`. Контейнер `api` поднимет FastAPI сервис, а контейнер `loop` начнет сбор данных с роутера каждые 60 секунд.

